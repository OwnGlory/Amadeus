% Загрузка аудиофайла
[y, Fs] = audioread('Hallelujah.mp3');

% Преобразование стерео в моно, если это необходимо
if size(y, 2) == 2
    y = sum(y, 2) / 2;
end

% Вычисление спектрограммы
[S, F, T] = spectrogram(y, 1024, 512, 1024, Fs);

% Вычисление мощности спектра
P = abs(S).^2;

% Нахождение пика в спектре мощности
[~, loc] = max(P);

% Вычисление BPM
bpm = mean(diff(T(loc))) / Fs * 60;

fprintf('BPM: %.2f\n', bpm);